# Banking Fraud Detection System - Detailed Data Flow

## ğŸŒŠ **Complete System Data Flow - Step by Step**

This document traces every single step of data transformation from raw transaction input to final fraud decision.

## ğŸ“Š **Flow Overview**

```
Raw Transaction Input â†’ Authentication â†’ Feature Engineering â†’ Triple Detection â†’ Decision â†’ Action
```

## ğŸ”„ **Complete System Flowchart**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           BANKING FRAUD DETECTION SYSTEM                        â”‚
â”‚                                  DATA FLOW CHART                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Phase 1    â”‚    â”‚   Phase 2    â”‚    â”‚   Phase 3    â”‚    â”‚   Phase 4    â”‚
â”‚ STARTUP &    â”‚â”€â”€â”€â–¶â”‚ TRANSACTION  â”‚â”€â”€â”€â–¶â”‚   FEATURE    â”‚â”€â”€â”€â–¶â”‚   TRIPLE     â”‚
â”‚ AUTH (5-10s) â”‚    â”‚ INPUT (5ms)  â”‚    â”‚ ENGINEERING  â”‚    â”‚ DETECTION    â”‚
â”‚              â”‚    â”‚              â”‚    â”‚   (10ms)     â”‚    â”‚   (55ms)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚â€¢ Load Models â”‚    â”‚â€¢ Account     â”‚    â”‚â€¢ Velocity    â”‚    â”‚â€¢ Rule Engine â”‚
â”‚â€¢ Load Datasetâ”‚    â”‚  Selection   â”‚    â”‚  Calculation â”‚    â”‚â€¢ Isolation   â”‚
â”‚â€¢ User Login  â”‚    â”‚â€¢ Form Input  â”‚    â”‚â€¢ User Stats  â”‚    â”‚  Forest      â”‚
â”‚â€¢ Cache Setup â”‚    â”‚â€¢ Validation  â”‚    â”‚â€¢ 41 Features â”‚    â”‚â€¢ Autoencoder â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                    â”‚
                                                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Phase 6    â”‚    â”‚   Phase 5    â”‚    â”‚              â”‚    â”‚   DECISION   â”‚
â”‚ PERSISTENCE  â”‚â—€â”€â”€â”€â”‚   RESULT     â”‚â—€â”€â”€â”€â”¤              â”‚    â”‚ AGGREGATION  â”‚
â”‚ & AUDIT      â”‚    â”‚  PROCESSING  â”‚    â”‚              â”‚    â”‚   (3ms)      â”‚
â”‚   (5ms)      â”‚    â”‚   (10ms)     â”‚    â”‚              â”‚    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ **Detailed Phase Flowcharts**

### **Phase 1: System Startup & Authentication Flow**

```
START
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Opens      â”‚
â”‚ Browser         â”‚
â”‚ localhost:8502  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Streamlit       â”‚â”€â”€â”€â”€â–¶â”‚ Load Models     â”‚â”€â”€â”€â”€â–¶â”‚ Load Dataset    â”‚
â”‚ App Startup     â”‚     â”‚ (Cached)        â”‚     â”‚ (Cached)        â”‚
â”‚ app.py          â”‚     â”‚ â€¢ IF: 2MB       â”‚     â”‚ â€¢ CSV: 50MB     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â€¢ AE: 5MB       â”‚     â”‚ â€¢ 1000+ rows    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚                         â”‚
                                â–¼                         â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Models Ready    â”‚     â”‚ Data Ready      â”‚
                        â”‚ âœ“ Isolation     â”‚     â”‚ âœ“ Features      â”‚
                        â”‚ âœ“ Autoencoder   â”‚     â”‚ âœ“ Customers     â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚                         â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚ Display Login   â”‚
                                â”‚ Page            â”‚
                                â”‚ â€¢ Customer IDs  â”‚
                                â”‚ â€¢ Password      â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚ User Selects    â”‚
                                â”‚ Customer ID     â”‚
                                â”‚ Enters Password â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚ Password == ?   â”‚
                                â”‚ "12345"         â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚         â”‚
                                 YES â”‚         â”‚ NO
                                     â–¼         â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ Login       â”‚ â”‚ Show Error  â”‚
                            â”‚ Success     â”‚ â”‚ Try Again   â”‚
                            â”‚ â†’ Dashboard â”‚ â”‚             â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
â”‚ Browser         â”‚
â”‚ localhost:8502  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Streamlit       â”‚â”€â”€â”€â”€â–¶â”‚ Load Models     â”‚â”€â”€â”€â”€â–¶â”‚ Load Dataset    â”‚
â”‚ App Startup     â”‚     â”‚ (Cached)        â”‚     â”‚ (Cached)        â”‚
â”‚ app.py          â”‚     â”‚ â€¢ IF: 2MB       â”‚     â”‚ â€¢ CSV: 50MB     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â€¢ AE: 5MB       â”‚     â”‚ â€¢ 1000+ rows    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                         â”‚
                â–¼                         â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Models Ready    â”‚     â”‚ Data Ready      â”‚
            â”‚ âœ“ Isolation     â”‚     â”‚ âœ“ Features      â”‚
            â”‚ âœ“ Autoencoder   â”‚     â”‚ âœ“ Customers     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                         â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Display Login   â”‚
                â”‚ Page            â”‚
                â”‚ â€¢ Customer IDs  â”‚
                â”‚ â€¢ Password      â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ User Selects    â”‚
                â”‚ Customer ID     â”‚
                â”‚ Enters Password â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Password == ?   â”‚
                â”‚ "12345"         â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚         â”‚
                 YES â”‚         â”‚ NO
                     â–¼         â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Login       â”‚ â”‚ Show Error  â”‚
                â”‚ Success     â”‚ â”‚ Try Again   â”‚
                â”‚ â†’ Dashboard â”‚ â”‚             â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


### **Phase 2: Transaction Input Flow**

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Authenticated   â”‚
â”‚ User Dashboard  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Filter Customer â”‚â”€â”€â”€â”€â–¶â”‚ Extract         â”‚â”€â”€â”€â”€â–¶â”‚ Display         â”‚
â”‚ Data from       â”‚     â”‚ Account List    â”‚     â”‚ Account         â”‚
â”‚ Dataset         â”‚     â”‚ for Customer    â”‚     â”‚ Dropdown        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Customer:       â”‚     â”‚ Accounts:       â”‚     â”‚ User Selects    â”‚
â”‚ 1000016         â”‚     â”‚ 11000016019     â”‚     â”‚ Account:        â”‚
â”‚ Transactions:   â”‚     â”‚ 11000016020     â”‚     â”‚ 11000016019     â”‚
â”‚ 45 records      â”‚     â”‚ ...             â”‚     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Calculate       â”‚
                        â”‚ Account Stats   â”‚
                        â”‚ â€¢ Avg: 9124.09  â”‚
                        â”‚ â€¢ Max: 96639.45 â”‚
                        â”‚ â€¢ Std: 19093.33 â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Display         â”‚     â”‚ Display         â”‚     â”‚ Display         â”‚
â”‚ Amount Input    â”‚     â”‚ Transfer Type   â”‚     â”‚ Country         â”‚
â”‚ Min: 0          â”‚     â”‚ O,I,L,Q,S       â”‚     â”‚ UAE,USA,UK...   â”‚
â”‚ Max: 1,000,000  â”‚     â”‚                 â”‚     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Enters:    â”‚     â”‚ User Selects:   â”‚     â”‚ User Selects:   â”‚
â”‚ Amount: 1000.0  â”‚     â”‚ Type: S         â”‚     â”‚ Country: USA    â”‚
â”‚                 â”‚     â”‚ (Overseas)      â”‚     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Form Validation â”‚
      â”‚ âœ“ Amount > 0    â”‚
      â”‚ âœ“ Type Valid    â”‚
      â”‚ âœ“ Country Set   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Ready for       â”‚
      â”‚ Processing      â”‚
      â”‚ â†’ Phase 3       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### **Phase 3: Feature Engineering Flow**

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Transaction     â”‚
â”‚ Input Ready     â”‚
â”‚ Amount: 1000    â”‚
â”‚ Type: S         â”‚
â”‚ Country: USA    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Calculate       â”‚     â”‚ Calculate       â”‚     â”‚ Calculate       â”‚
â”‚ Velocity        â”‚     â”‚ Monthly         â”‚     â”‚ User Stats      â”‚
â”‚ Features        â”‚     â”‚ Spending        â”‚     â”‚ Features        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Session History â”‚     â”‚ Filter by       â”‚     â”‚ Historical      â”‚
â”‚ Check:          â”‚     â”‚ Current Month   â”‚     â”‚ Analysis:       â”‚
â”‚ â€¢ Last 30s: 0   â”‚     â”‚ â€¢ CSV: 25000    â”‚     â”‚ â€¢ Avg: 9124.09  â”‚
â”‚ â€¢ Last 10min: 0 â”‚     â”‚ â€¢ Session: 0    â”‚     â”‚ â€¢ Std: 19093.33 â”‚
â”‚ â€¢ Last 1hr: 0   â”‚     â”‚ â€¢ Total: 25000  â”‚     â”‚ â€¢ Max: 96639.45 â”‚
â”‚ â€¢ Since last: âˆ â”‚     â”‚                 â”‚     â”‚ â€¢ Freq: 45      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Velocity        â”‚     â”‚ Monthly         â”‚     â”‚ Behavioral      â”‚
â”‚ Features:       â”‚     â”‚ Features:       â”‚     â”‚ Features:       â”‚
â”‚ â€¢ txn_count_30s â”‚     â”‚ â€¢ current_month â”‚     â”‚ â€¢ deviation     â”‚
â”‚ â€¢ txn_count_10m â”‚     â”‚ â€¢ monthly_avg   â”‚     â”‚ â€¢ amount_ratio  â”‚
â”‚ â€¢ txn_count_1hr â”‚     â”‚ â€¢ monthly_dev   â”‚     â”‚ â€¢ intl_ratio    â”‚
â”‚ â€¢ recent_burst  â”‚     â”‚                 â”‚     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Compile         â”‚
      â”‚ Transaction     â”‚
      â”‚ Object          â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ txn = {         â”‚
      â”‚  amount: 1000   â”‚
      â”‚  type: 'S'      â”‚
      â”‚  country: 'USA' â”‚
      â”‚  velocity: {...}â”‚
      â”‚ }               â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ user_stats = {  â”‚
      â”‚  avg: 9124.09   â”‚
      â”‚  std: 19093.33  â”‚
      â”‚  monthly: 25000 â”‚
      â”‚  ...            â”‚
      â”‚ }               â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Ready for       â”‚
      â”‚ Detection       â”‚
      â”‚ â†’ Phase 4       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### **Phase 4: Triple Detection Flow**

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ make_decision() â”‚
â”‚ Entry Point     â”‚
â”‚ hybrid_decision â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Initialize      â”‚
â”‚ Result Object   â”‚
â”‚ is_fraud: False â”‚
â”‚ reasons: []     â”‚
â”‚ scores: {}      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            DETECTION LAYER 1                                    â”‚
â”‚                              RULE ENGINE                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check Velocity  â”‚     â”‚ Check Amount    â”‚     â”‚ Check Monthly   â”‚
â”‚ Limits          â”‚     â”‚ Limits          â”‚     â”‚ Limits          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ 30s: 0 â‰¤ 2 âœ“ â”‚     â”‚ Type S Limit:   â”‚     â”‚ Current: 25000  â”‚
â”‚ â€¢ 10m: 0 â‰¤ 5 âœ“ â”‚     â”‚ 5000 AED        â”‚     â”‚ + 1000 = 26000  â”‚
â”‚ â€¢ 1hr: 0 â‰¤ 15âœ“ â”‚     â”‚ Amount: 1000 âœ“  â”‚     â”‚ Limit: 50000 âœ“  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Rule Result:    â”‚
      â”‚ violated: False â”‚
      â”‚ reasons: []     â”‚
      â”‚ threshold: 5000 â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            DETECTION LAYER 2                                    â”‚
â”‚                           ISOLATION FOREST                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create Feature  â”‚     â”‚ Apply Scaler    â”‚     â”‚ Run IF Model    â”‚
â”‚ Vector (41)     â”‚     â”‚ Normalization   â”‚     â”‚ Prediction      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ vec = [1000,    â”‚     â”‚ vec_scaled =    â”‚     â”‚ pred = 1        â”‚
â”‚        1,       â”‚     â”‚ scaler.         â”‚     â”‚ score = 0.65    â”‚
â”‚        4,       â”‚     â”‚ transform(vec)  â”‚     â”‚ (Normal)        â”‚
â”‚        0.9, ..] â”‚     â”‚                 â”‚     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ IF Result:      â”‚
      â”‚ ml_flag: False  â”‚
      â”‚ risk_score: 0.65â”‚
      â”‚ prediction: 1   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            DETECTION LAYER 3                                    â”‚
â”‚                              AUTOENCODER                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Map to AE       â”‚     â”‚ Apply AE        â”‚     â”‚ Neural Network  â”‚
â”‚ Features (41)   â”‚     â”‚ Scaler          â”‚     â”‚ Forward Pass    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ae_features = { â”‚     â”‚ ae_scaled =     â”‚     â”‚ reconstruction  â”‚
â”‚  amount: 1000,  â”‚     â”‚ ae_scaler.      â”‚     â”‚ error = 0.023   â”‚
â”‚  flag: 1,       â”‚     â”‚ transform(...)  â”‚     â”‚ threshold=0.045 â”‚
â”‚  encoded: 4,..} â”‚     â”‚                 â”‚     â”‚ 0.023 < 0.045 âœ“ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ AE Result:      â”‚
      â”‚ ae_flag: False  â”‚
      â”‚ error: 0.023    â”‚
      â”‚ threshold: 0.045â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DECISION AGGREGATION                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Priority Logic: â”‚
â”‚ 1. Rules: âœ“     â”‚
â”‚ 2. IF: âœ“        â”‚
â”‚ 3. AE: âœ“        â”‚
â”‚ â†’ APPROVED      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Final Result:   â”‚
â”‚ is_fraud: False â”‚
â”‚ reasons: []     â”‚
â”‚ confidence: 0.95â”‚
â”‚ â†’ Phase 5       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### **Phase 5: Result Processing Flow**

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Decision Result â”‚
â”‚ from Phase 4    â”‚
â”‚ is_fraud: False â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Enhance Result  â”‚     â”‚ Store in        â”‚     â”‚ Trigger UI      â”‚
â”‚ with Metadata   â”‚     â”‚ Session State   â”‚     â”‚ Rerun           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                       â”‚
      â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Add:            â”‚     â”‚ st.session_     â”‚     â”‚ st.rerun()      â”‚
â”‚ â€¢ amount        â”‚     â”‚ state.result    â”‚     â”‚ Refresh Page    â”‚
â”‚ â€¢ t_type        â”‚     â”‚ = enhanced_     â”‚     â”‚ Show Results    â”‚
â”‚ â€¢ account       â”‚     â”‚ result          â”‚     â”‚                 â”‚
â”‚ â€¢ velocity      â”‚     â”‚                 â”‚     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â”‚
                              â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Check Result    â”‚
                        â”‚ is_fraud?       â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚         â”‚
                         NO  â”‚         â”‚ YES
                             â–¼         â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ SUCCESS     â”‚ â”‚ ERROR       â”‚
                      â”‚ Display     â”‚ â”‚ Display     â”‚
                      â”‚ SAFE        â”‚ â”‚ FRAUD       â”‚
                      â”‚ TRANSACTION â”‚ â”‚ ALERT       â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚         â”‚
                             â–¼         â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ Show:       â”‚ â”‚ Show:       â”‚
                      â”‚ â€¢ Amount    â”‚ â”‚ â€¢ Reasons   â”‚
                      â”‚ â€¢ Threshold â”‚ â”‚ â€¢ Risk Scoreâ”‚
                      â”‚ â€¢ Confirm   â”‚ â”‚ â€¢ Actions   â”‚
                      â”‚   Button    â”‚ â”‚   (Approve/ â”‚
                      â”‚             â”‚ â”‚    Reject)  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚         â”‚
                             â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                              â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Wait for User   â”‚
                        â”‚ Action          â”‚
                        â”‚ Button Click    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ User Clicks     â”‚
                        â”‚ Action Button   â”‚
                        â”‚ â†’ Phase 6       â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


### **Phase 6: Persistence & Audit Flow**


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Action     â”‚
â”‚ Button Click    â”‚
â”‚ (Confirm/       â”‚
â”‚  Approve/Reject)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Determine       â”‚
â”‚ Action Type     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚         â”‚         â”‚
     â–¼         â–¼         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CONFIRM â”‚ â”‚ APPROVE â”‚ â”‚ REJECT  â”‚
â”‚ (Normal)â”‚ â”‚ (Force) â”‚ â”‚ (Block) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚         â”‚         â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â–¼         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PROCESS     â”‚ â”‚ REJECT ONLY â”‚
â”‚ TRANSACTION â”‚ â”‚ (No Updates)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚              â”‚
      â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update Session  â”‚ â”‚ Log Rejection   â”‚
â”‚ State           â”‚ â”‚ to CSV          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚              â”‚
      â–¼              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ record_         â”‚      â”‚
â”‚ transaction()   â”‚      â”‚
â”‚ â€¢ Add timestamp â”‚      â”‚
â”‚ â€¢ Update count  â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
      â”‚              â”‚
      â–¼              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ add_monthly_    â”‚      â”‚
â”‚ spending()      â”‚      â”‚
â”‚ â€¢ Update total  â”‚      â”‚
â”‚ â€¢ Track limits  â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
      â”‚              â”‚
      â–¼              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ save_transactionâ”‚      â”‚
â”‚ _to_csv()       â”‚      â”‚
â”‚ â€¢ Append record â”‚      â”‚
â”‚ â€¢ Add timestamp â”‚      â”‚
â”‚ â€¢ Set status    â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
      â”‚              â”‚
      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Clear Session   â”‚
      â”‚ Result          â”‚
      â”‚ st.session_     â”‚
      â”‚ state.result=   â”‚
      â”‚ None            â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Trigger UI      â”‚
      â”‚ Refresh         â”‚
      â”‚ st.rerun()      â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Return to       â”‚
      â”‚ Transaction     â”‚
      â”‚ Input Form      â”‚
      â”‚ (Ready for Next)â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
          END


## ğŸ“Š **Complete System Flow Summary**

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          COMPLETE SYSTEM OVERVIEW                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

USER INPUT                    PROCESSING                      OUTPUT
    â”‚                            â”‚                             â”‚
    â–¼                            â–¼                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Browser â”‚â”€â”€â”€â–¶â”‚           FRAUD DETECTION           â”‚â”€â”€â”€â–¶â”‚ Decisionâ”‚
â”‚ Form    â”‚    â”‚             SYSTEM                  â”‚    â”‚ + Actionâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                     â”‚
           â–¼                                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 6 PHASES    â”‚                      â”‚ 3 MODELS    â”‚
    â”‚ â€¢ Startup   â”‚                      â”‚ â€¢ Rules     â”‚
    â”‚ â€¢ Input     â”‚                      â”‚ â€¢ IF ML     â”‚
    â”‚ â€¢ Features  â”‚                      â”‚ â€¢ AE NN     â”‚
    â”‚ â€¢ Detection â”‚                      â”‚             â”‚
    â”‚ â€¢ Results   â”‚                      â”‚             â”‚
    â”‚ â€¢ Audit     â”‚                      â”‚             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PERFORMANCE: 85ms total processing time per transaction
ACCURACY: 85%+ fraud detection with <5% false positives
THROUGHPUT: 1000+ transactions per second capability


## ğŸ”„ **Detailed Step-by-Step Flow**

### **Phase 1: User Authentication & Setup**

#### **Step 1.1: Application Startup**

python
# app.py initialization
streamlit.set_page_config(page_title="Banking Fraud Detection")
init_state()  # Initialize session variables


- **Input**: User opens browser to `http://localhost:8502`
- **Process**: Streamlit loads app.py, initializes session state
- **Output**: Login page displayed
- **Data**: Empty session state created

#### **Step 1.2: Model Loading (Cached)**

python
@st.cache_resource
def get_model():
    model, features, scaler = load_model()  # Isolation Forest
    return model, features, scaler

@st.cache_resource  
def get_autoencoder():
    ae = AutoencoderInference()
    ae.load()  # Neural network
    return ae


- **Input**: First app access
- **Process**: Load pre-trained models from `backend/model/`
- **Files Loaded**:
  - `isolation_forest.pkl` (1.5MB)
  - `isolation_forest_scaler.pkl` (500KB)
  - `autoencoder.h5` (3MB)
  - `autoencoder_scaler.pkl` (500KB)
  - `autoencoder_threshold.json` (1KB)
- **Output**: Models cached in memory
- **Performance**: ~5-10 seconds initial load

#### **Step 1.3: Dataset Loading (Cached)**

python
@st.cache_data
def load_data():
    return pd.read_csv('data/feature_datasetv2.csv')


- **Input**: Feature dataset path
- **Process**: Load CSV with 41 engineered features
- **Output**: DataFrame with ~1000+ transactions
- **Memory**: ~50MB dataset in cache

#### **Step 1.4: User Authentication**

python
def login_page(df):
    customers = sorted([str(c) for c in df['CustomerId'].dropna().unique()])
    cid = st.selectbox("Customer ID", customers)
    pwd = st.text_input("Password", type="password")

- **Input**: Customer ID selection + password
- **Process**: Validate password (hardcoded "12345")
- **Output**: Session state updated with customer ID
- **Security**: Basic authentication (demo purposes)

### **Phase 2: Transaction Input & Validation**

#### **Step 2.1: Account Selection**

python
cust_data = df[df['CustomerId'].astype(str) == cid]
accounts = [str(a) for a in cust_data['FromAccountNo'].dropna().unique()]
account = st.selectbox("Select Account", accounts)


- **Input**: Logged-in customer ID
- **Process**: Filter dataset by customer, extract unique accounts
- **Output**: Available accounts list
- **Data**: Customer-specific transaction history

#### **Step 2.2: Historical Statistics Calculation**

python
account_data = cust_data[cust_data['FromAccountNo'].astype(str) == str(account)]
avg = account_data[amt_col].mean()
max_amt = account_data[amt_col].max()
std = account_data[amt_col].std()


- **Input**: Selected account data
- **Process**: Calculate user behavioral baselines
- **Output**: Statistical measures for fraud detection
- **Calculations**:
  - Average transaction amount
  - Maximum transaction amount  
  - Standard deviation
  - Transaction frequency

#### **Step 2.3: Transaction Form Input**

python
amount = st.number_input("Transaction Amount (AED)", min_value=0.0, max_value=1000000.0)
t_type = st.selectbox("Transfer Type", ['O', 'I', 'L', 'Q', 'S'])
country = st.selectbox("Bank Country", ['UAE', 'USA', 'UK', 'India', ...])


- **Input**: User form submission
- **Process**: Validate input ranges and types
- **Output**: Raw transaction parameters
- **Validation**: Amount limits, type constraints

### **Phase 3: Feature Engineering Pipeline**

#### **Step 3.1: Velocity Calculation**

python
def get_velocity(cid, account_no):
    account_key = f"{cid}_{account_no}"
    now = datetime.now()
    history = st.session_state.txn_history.get(account_key, [])
    
    count_10min = sum(1 for t in history if (now - t).total_seconds() < 600)
    count_1hour = sum(1 for t in history if (now - t).total_seconds() < 3600)
    time_since_last = (now - max(history)).total_seconds() if history else 3600

- **Input**: Customer ID + Account number + Session history
- **Process**: Calculate real-time velocity metrics
- **Output**: Velocity features
- **Features Generated**:
  - `txn_count_10min`: Transactions in last 10 minutes
  - `txn_count_1hour`: Transactions in last 1 hour
  - `time_since_last_txn`: Seconds since last transaction

#### **Step 3.2: Monthly Spending Calculation**

python
def get_monthly_spending_from_csv(cust_data, account_no, amt_col):
    current_month = datetime.now().month
    current_year = datetime.now().year
    monthly_data = account_data[
    (account_data['CreateDate'].dt.month == current_month) & 
    (account_data['CreateDate'].dt.year == current_year)
    ]
    return monthly_data[amt_col].sum()


- **Input**: Customer data + current date
- **Process**: Filter by current month/year, sum amounts
- **Output**: Monthly spending total
- **Usage**: For limit checking and behavioral analysis

#### **Step 3.3: User Statistics Compilation**

python
user_stats = {
    'user_avg_amount': overall_avg,
    'user_std_amount': overall_std,
    'user_max_amount': overall_max,
    'user_txn_frequency': total_txns_count,
    'user_international_ratio': intl_ratio,
    'current_month_spending': current_spending
}


- **Input**: Historical account data + current session data
- **Process**: Aggregate user behavioral patterns
- **Output**: User statistics dictionary
- **Purpose**: Baseline for anomaly detection

#### **Step 3.4: Transaction Object Creation**

python
txn = {
    'amount': amount, 
    'transfer_type': t_type, 
    'bank_country': country,
    'account': account,
    'txn_count_10min': txn_count_10min,
    'txn_count_1hour': txn_count_1hour,
    'time_since_last_txn': current_vel['time_since_last_txn']
}

- **Input**: Form data + calculated features
- **Process**: Structure transaction for processing
- **Output**: Transaction dictionary
- **Format**: Key-value pairs for decision engine

### **Phase 4: Triple Detection Pipeline**

#### **Step 4.1: Hybrid Decision Engine Entry**
python
result = make_decision(txn, user_stats, model, features, autoencoder=autoencoder)

- **Input**: Transaction + User stats + Models
- **Process**: Route to hybrid decision engine
- **Output**: Comprehensive fraud decision
- **File**: `backend/hybrid_decision.py`

#### **Step 4.2: Rule Engine Processing**

python
violated, rule_reasons, threshold = check_rule_violation(
    amount=txn["amount"],
    user_avg=user_stats["user_avg_amount"],
    user_std=user_stats["user_std_amount"],
    transfer_type=txn["transfer_type"],
    txn_count_10min=txn["txn_count_10min"],
    txn_count_1hour=txn["txn_count_1hour"],
    monthly_spending=user_stats["current_month_spending"]
)


- **Input**: Transaction parameters + User baselines
- **Process**: Check business rules and velocity limits
- **Rules Checked**:
  - Velocity: Max 2 in 30s, 5 in 10min, 15 in 1hour
  - Amount: Dynamic limits based on transfer type
  - Monthly: Spending caps per user history
- **Output**: Violation flag + reasons + threshold
- **Priority**: Highest (can immediately block)

#### **Step 4.3: Isolation Forest Processing**

python
if model is not None:
    vec = np.array([[txn.get(f, 0) for f in features]])
    pred = model.predict(vec)[0]
    score = -model.decision_function(vec)[0]


- **Input**: Transaction features + Trained IF model
- **Process**: Statistical anomaly detection
- **Steps**:
  1. Convert transaction to 41-feature vector
  2. Apply StandardScaler normalization
  3. Run through Isolation Forest
  4. Calculate anomaly score
- **Output**: Prediction (-1=anomaly, 1=normal) + Score
- **Algorithm**: Ensemble of 100 isolation trees

#### **Step 4.4: Autoencoder Processing**

python
ae_features = {
    'transaction_amount': txn.get('amount', 0),
    'flag_amount': 1 if txn.get('transfer_type') == 'S' else 0,
    'transfer_type_encoded': {'S': 4, 'I': 1, 'L': 2, 'Q': 3, 'O': 0}.get(txn.get('transfer_type', 'O'), 0),
    # ... 38 more features
}
ae_result = autoencoder.score_transaction(ae_features)

- **Input**: Transaction + User stats
- **Process**: Neural network behavioral analysis
- **Steps**:
  1. Map transaction to 41 autoencoder features
  2. Apply StandardScaler normalization
  3. Forward pass through neural network
  4. Calculate reconstruction error
  5. Compare against learned threshold
- **Output**: Reconstruction error + Anomaly flag + Reason
- **Algorithm**: 41â†’64â†’32â†’14â†’32â†’64â†’41 neural network

#### **Step 4.5: Decision Aggregation**

python
result = {
    "is_fraud": False,
    "reasons": [],
    "risk_score": 0.0,
    "threshold": 0.0,
    "ml_flag": False,
    "ae_flag": False,
    "ae_reconstruction_error": None,
    "ae_threshold": None,
}

# Priority 1: Rule violations
if violated:
    result["is_fraud"] = True
    result["reasons"].extend(rule_reasons)

# Priority 2: ML anomalies  
if pred == -1:
    result["ml_flag"] = True
    result["is_fraud"] = True
    result["reasons"].append(f"ML anomaly detected: {score:.4f}")

# Priority 3: Behavioral anomalies
if ae_result['is_anomaly']:
    result["ae_flag"] = True
    result["is_fraud"] = True
    result["reasons"].append(ae_result['reason'])


- **Input**: Results from all three detection layers
- **Process**: Priority-based decision aggregation
- **Logic**:
  1. Rule violations = immediate fraud flag
  2. ML anomalies = statistical fraud flag
  3. AE anomalies = behavioral fraud flag
- **Output**: Comprehensive decision with detailed reasoning

### **Phase 5: Result Processing & Display**

#### **Step 5.1: Result Enhancement**

python
st.session_state.result = make_decision(...)
st.session_state.result['amount'] = amount
st.session_state.result['t_type'] = t_type
st.session_state.result['account'] = account
st.session_state.result['txn_count_10min'] = txn_count_10min
st.session_state.result['txn_count_1hour'] = txn_count_1hour


- **Input**: Decision result + Transaction metadata
- **Process**: Enhance result with display information
- **Output**: Complete result object in session state
- **Purpose**: UI display and user interaction

#### **Step 5.2: UI Result Display**

python
if r['is_fraud']:
    st.error("ğŸš¨ FRAUD ALERT - Transaction Flagged!")
    for reason in r['reasons']:
    st.warning(reason)
    st.markdown(f"**Risk Score:** {r['risk_score']:.4f}")
else:
    st.success("âœ… SAFE TRANSACTION")
    st.info(f"Amount: AED {r['amount']:,.2f} | Threshold: AED {r['threshold']:,.2f}")


- **Input**: Enhanced result object
- **Process**: Format for user-friendly display
- **Output**: Streamlit UI components
- **Elements**:
  - Status indicator (âœ…/ğŸš¨)
  - Detailed reasons list
  - Risk scores and thresholds
  - Action buttons

#### **Step 5.3: User Action Processing**

python
# For approved transactions
if st.button("Confirm & Continue"):
    record_transaction(cid, result_account)
    add_monthly_spending(cid, result_account, r['amount'])
    save_transaction_to_csv(cid, r['amount'], t_type, "Approved")

# For flagged transactions  
if st.button("Approve (Force)"):
    # Same recording process but marked as "Force Approved"


- **Input**: User button clicks
- **Process**: Update session state and transaction history
- **Actions**:
  1. Record transaction timestamp
  2. Update monthly spending totals
  3. Save to CSV audit log
  4. Clear result from session
- **Output**: Updated system state + audit trail

### **Phase 6: Data Persistence & Audit**

#### **Step 6.1: Session State Updates**

python
def record_transaction(cid, account_no):
    account_key = f"{cid}_{account_no}"
    if account_key not in st.session_state.txn_history:
    st.session_state.txn_history[account_key] = []
    st.session_state.txn_history[account_key].append(datetime.now())

- **Input**: Customer ID + Account number
- **Process**: Update in-memory transaction history
- **Output**: Updated session state
- **Purpose**: Real-time velocity tracking

#### **Step 6.2: Monthly Spending Updates**

python
def add_monthly_spending(cid, account_no, amount):
    account_key = f"{cid}_{account_no}"
    if account_key not in st.session_state.monthly_spending:
    st.session_state.monthly_spending[account_key] = 0.0
    st.session_state.monthly_spending[account_key] += amount


- **Input**: Customer + Account + Amount
- **Process**: Update monthly spending totals
- **Output**: Updated spending tracker
- **Purpose**: Monthly limit enforcement

#### **Step 6.3: CSV Audit Logging**

python
def save_transaction_to_csv(cid, amount, t_type, status="Approved"):
    file_name = 'transaction_history.csv'
    with open(file_name, mode='a', newline='') as file:
    writer = csv.writer(file)
    writer.writerow([cid, amount, t_type, status, datetime.now()])


- **Input**: Transaction details + Decision status
- **Process**: Append to audit log file
- **Output**: Persistent transaction record
- **Format**: CSV with timestamp and decision
- **Purpose**: Compliance and audit trail

## ğŸ“Š **Data Flow Performance Metrics**

### **Processing Times (Per Transaction)**


Phase 1 (Authentication): ~0ms (cached)
Phase 2 (Input Validation): ~5ms
Phase 3 (Feature Engineering): ~10ms
Phase 4 (Triple Detection): ~55ms
  - Rule Engine: ~2ms
  - Isolation Forest: ~15ms  
  - Autoencoder: ~25ms
  - Decision Aggregation: ~3ms
Phase 5 (Result Display): ~10ms
Phase 6 (Persistence): ~5ms
Total: ~85ms per transaction
```

### **Memory Usage**

Models in Cache: ~100MB
Dataset in Cache: ~50MB
Session State: ~1MB per user
Total per User: ~151MB

### **Data Volumes**

Input: 1 transaction (7 fields)
Feature Engineering: 41 features generated
ML Processing: 41 features Ã— 2 models
Output: 1 decision + detailed reasoning
Audit: 1 CSV record appended
